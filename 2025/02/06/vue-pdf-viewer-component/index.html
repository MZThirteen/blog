<!DOCTYPE html><html lang="[&quot;zh_CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Vue3 PDF查看器组件实现 | 拾叁的博客</title><meta name="author" content="拾叁"><meta name="copyright" content="拾叁"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="概述本文介绍一个基于 Vue3 + TypeScript 的高性能 PDF 查看器组件，支持单页&#x2F;多页模式、懒加载、旋转、下载、打印等功能，适用于企业级应用。 核心特性 ✅ 单页&#x2F;多页显示模式：支持翻页模式和全部展示模式 ✅ 懒加载优化：多页模式下使用 IntersectionObserver 实现页面懒加载 ✅ 旋转功能：支持 90°、180°、270° 旋转 ✅ 下载功能：">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3 PDF查看器组件实现">
<meta property="og:url" content="https://muziless.gitee.io/bolg/2025/02/06/vue-pdf-viewer-component/index.html">
<meta property="og:site_name" content="拾叁的博客">
<meta property="og:description" content="概述本文介绍一个基于 Vue3 + TypeScript 的高性能 PDF 查看器组件，支持单页&#x2F;多页模式、懒加载、旋转、下载、打印等功能，适用于企业级应用。 核心特性 ✅ 单页&#x2F;多页显示模式：支持翻页模式和全部展示模式 ✅ 懒加载优化：多页模式下使用 IntersectionObserver 实现页面懒加载 ✅ 旋转功能：支持 90°、180°、270° 旋转 ✅ 下载功能：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://muziless.gitee.io/bolg/assets/cover/v3-6.webp">
<meta property="article:published_time" content="2025-02-06T08:40:00.000Z">
<meta property="article:modified_time" content="2026-02-06T08:54:45.561Z">
<meta property="article:author" content="拾叁">
<meta property="article:tag" content="Vue3">
<meta property="article:tag" content="PDF">
<meta property="article:tag" content="组件开发">
<meta property="article:tag" content="TypeScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://muziless.gitee.io/bolg/assets/cover/v3-6.webp"><link rel="shortcut icon" href="/blog/assets/images/favicon.png"><link rel="canonical" href="https://muziless.gitee.io/bolg/2025/02/06/vue-pdf-viewer-component/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/blog/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Vue3 PDF查看器组件实现',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-02-06 16:54:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/blog/assets/images/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/blog/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a><a href="/blog/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/blog/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/blog/assets/cover/v3-6.webp')"><nav id="nav"><span id="blog-info"><a href="/blog/" title="拾叁的博客"><span class="site-name">拾叁的博客</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vue3 PDF查看器组件实现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-06T08:40:00.000Z" title="Created 2025-02-06 16:40:00">2025-02-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-06T08:54:45.561Z" title="Updated 2026-02-06 16:54:45">2026-02-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/blog/categories/%E5%89%8D%E7%AB%AF/">前端</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Vue3 PDF查看器组件实现"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>本文介绍一个基于 Vue3 + TypeScript 的高性能 PDF 查看器组件，支持单页&#x2F;多页模式、懒加载、旋转、下载、打印等功能，适用于企业级应用。</p>
<h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><ul>
<li>✅ <strong>单页&#x2F;多页显示模式</strong>：支持翻页模式和全部展示模式</li>
<li>✅ <strong>懒加载优化</strong>：多页模式下使用 IntersectionObserver 实现页面懒加载</li>
<li>✅ <strong>旋转功能</strong>：支持 90°、180°、270° 旋转</li>
<li>✅ <strong>下载功能</strong>：支持各种格式源（URL、Blob、ArrayBuffer）的下载</li>
<li>✅ <strong>打印功能</strong>：集成浏览器打印功能</li>
<li>✅ <strong>格式校验</strong>：支持多种方式的 PDF 格式验证</li>
<li>✅ <strong>中文支持</strong>：配置 CJK 字体支持</li>
<li>✅ <strong>灵活配置</strong>：可自定义工具栏、页码、旋转等功能</li>
</ul>
<h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.x&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pdfjs-dist&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue-pdf-embed&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ant-design-vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.x&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="组件接口设计"><a href="#组件接口设计" class="headerlink" title="组件接口设计"></a>组件接口设计</h2><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Props</span> &#123;</span><br><span class="line">  <span class="comment">/** PDF 文件源：URL 或 Blob/ArrayBuffer */</span></span><br><span class="line">  <span class="attr">source</span>: <span class="title class_">PdfSource</span></span><br><span class="line">  <span class="comment">/** 容器最小高度 */</span></span><br><span class="line">  minHeight?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 容器固定高度（可选） */</span></span><br><span class="line">  height?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 初始旋转角度（0, 90, 180, 270），已废弃，请使用 toolbar.rotation */</span></span><br><span class="line">  rotation?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 工具栏配置 */</span></span><br><span class="line">  toolbar?: <span class="title class_">ToolbarConfig</span> | <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PdfSource</span> = <span class="built_in">string</span> | <span class="variable constant_">URL</span> | <span class="title class_">Blob</span> | <span class="title class_">ArrayBuffer</span> | <span class="title class_">Uint8Array</span> | <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<h3 id="工具栏配置"><a href="#工具栏配置" class="headerlink" title="工具栏配置"></a>工具栏配置</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ToolbarConfig</span> &#123;</span><br><span class="line">  pagination?: <span class="title class_">PaginationConfig</span> | <span class="built_in">boolean</span></span><br><span class="line">  rotation?: <span class="title class_">RotationConfig</span> | <span class="built_in">boolean</span></span><br><span class="line">  download?: <span class="title class_">DownloadConfig</span> | <span class="built_in">boolean</span></span><br><span class="line">  print?: <span class="title class_">PrintConfig</span> | <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PaginationConfig</span> &#123;</span><br><span class="line">  enabled?: <span class="built_in">boolean</span></span><br><span class="line">  initialPage?: <span class="built_in">number</span></span><br><span class="line">  showAllPages?: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">RotationConfig</span> &#123;</span><br><span class="line">  enabled?: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DownloadConfig</span> &#123;</span><br><span class="line">  enabled?: <span class="built_in">boolean</span></span><br><span class="line">  fileName?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PrintConfig</span> &#123;</span><br><span class="line">  enabled?: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> emit = defineEmits&lt;&#123;</span><br><span class="line">  <span class="attr">loaded</span>: [<span class="attr">totalPages</span>: <span class="built_in">number</span>]</span><br><span class="line">  <span class="attr">error</span>: [<span class="attr">error</span>: <span class="title class_">Error</span>]</span><br><span class="line">&#125;&gt;()</span><br></pre></td></tr></table></figure>

<h3 id="暴露的方法"><a href="#暴露的方法" class="headerlink" title="暴露的方法"></a>暴露的方法</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  reload,           <span class="comment">// 重新加载 PDF</span></span><br><span class="line">  print,            <span class="comment">// 打印</span></span><br><span class="line">  download,         <span class="comment">// 下载</span></span><br><span class="line">  rotateLeft,       <span class="comment">// 左转 90°</span></span><br><span class="line">  rotateRight,      <span class="comment">// 右转 90°</span></span><br><span class="line">  resetRotation,    <span class="comment">// 重置旋转</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="核心功能实现"><a href="#核心功能实现" class="headerlink" title="核心功能实现"></a>核心功能实现</h2><h3 id="1-PDF-js-配置"><a href="#1-PDF-js-配置" class="headerlink" title="1. PDF.js 配置"></a>1. PDF.js 配置</h3><h4 id="Worker-配置"><a href="#Worker-配置" class="headerlink" title="Worker 配置"></a>Worker 配置</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> pdfjsLib <span class="keyword">from</span> <span class="string">&#x27;pdfjs-dist&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PDF.js CDN 基础路径</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PDF_CDN_BASE</span> = <span class="string">`//unpkg.com/pdfjs-dist@<span class="subst">$&#123;pdfjsLib.version&#125;</span>`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 PDF.js worker</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span> !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">  pdfjsLib.<span class="property">GlobalWorkerOptions</span>.<span class="property">workerSrc</span> = <span class="string">`<span class="subst">$&#123;PDF_CDN_BASE&#125;</span>/build/pdf.worker.min.mjs`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="中文字体支持"><a href="#中文字体支持" class="headerlink" title="中文字体支持"></a>中文字体支持</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PdfFontConfig</span> &#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">cMapUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">cMapPacked</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="attr">standardFontDataUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isEvalSupported</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="attr">useSystemFonts</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createPdfFontConfig = (<span class="attr">url</span>: <span class="built_in">string</span>): <span class="function"><span class="params">PdfFontConfig</span> =&gt;</span> (&#123;</span><br><span class="line">  url,</span><br><span class="line">  <span class="attr">cMapUrl</span>: <span class="string">`<span class="subst">$&#123;PDF_CDN_BASE&#125;</span>/cmaps/`</span>,</span><br><span class="line">  <span class="attr">cMapPacked</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">standardFontDataUrl</span>: <span class="string">`<span class="subst">$&#123;PDF_CDN_BASE&#125;</span>/standard_fonts/`</span>,</span><br><span class="line">  <span class="attr">isEvalSupported</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">useSystemFonts</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-PDF-格式校验"><a href="#2-PDF-格式校验" class="headerlink" title="2. PDF 格式校验"></a>2. PDF 格式校验</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validatePdfFormat = (<span class="attr">source</span>: <span class="title class_">PdfSource</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!source) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. 如果是 Blob，检查 MIME 类型</span></span><br><span class="line">  <span class="keyword">if</span> (source <span class="keyword">instanceof</span> <span class="title class_">Blob</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> validTypes = [<span class="string">&#x27;application/pdf&#x27;</span>, <span class="string">&#x27;application/x-pdf&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> validTypes.<span class="title function_">includes</span>(source.<span class="property">type</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 如果是 URL 字符串，检查文件扩展名</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> source === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(source, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>)</span><br><span class="line">      <span class="keyword">const</span> pathname = url.<span class="property">pathname</span>.<span class="title function_">toLowerCase</span>()</span><br><span class="line">      <span class="keyword">return</span> pathname.<span class="title function_">endsWith</span>(<span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> source.<span class="title function_">toLowerCase</span>().<span class="title function_">endsWith</span>(<span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 如果是 URL 对象，检查路径</span></span><br><span class="line">  <span class="keyword">if</span> (source <span class="keyword">instanceof</span> <span class="variable constant_">URL</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pathname = source.<span class="property">pathname</span>.<span class="title function_">toLowerCase</span>()</span><br><span class="line">    <span class="keyword">return</span> pathname.<span class="title function_">endsWith</span>(<span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. 如果是 ArrayBuffer 或 Uint8Array，检查 PDF 文件头（%PDF-）</span></span><br><span class="line">  <span class="keyword">if</span> (source <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> || source <span class="keyword">instanceof</span> <span class="title class_">Uint8Array</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> bytes = source <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> ? <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(source) : source</span><br><span class="line">    <span class="comment">// PDF 文件头: %PDF- (0x25, 0x50, 0x44, 0x46, 0x2D)</span></span><br><span class="line">    <span class="keyword">if</span> (bytes.<span class="property">length</span> &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        bytes[<span class="number">0</span>] === <span class="number">0x25</span> &amp;&amp; <span class="comment">// %</span></span><br><span class="line">        bytes[<span class="number">1</span>] === <span class="number">0x50</span> &amp;&amp; <span class="comment">// P</span></span><br><span class="line">        bytes[<span class="number">2</span>] === <span class="number">0x44</span> &amp;&amp; <span class="comment">// D</span></span><br><span class="line">        bytes[<span class="number">3</span>] === <span class="number">0x46</span> &amp;&amp; <span class="comment">// F</span></span><br><span class="line">        bytes[<span class="number">4</span>] === <span class="number">0x2d</span>    <span class="comment">// -</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-懒加载实现"><a href="#3-懒加载实现" class="headerlink" title="3. 懒加载实现"></a>3. 懒加载实现</h3><h4 id="配置参数"><a href="#配置参数" class="headerlink" title="配置参数"></a>配置参数</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">LAZY_LOADING_CONFIG</span> = &#123;</span><br><span class="line">  <span class="attr">rootMargin</span>: <span class="string">&#x27;50px&#x27;</span>,    <span class="comment">// 提前 50px 加载</span></span><br><span class="line">  <span class="attr">threshold</span>: <span class="number">0.1</span>,        <span class="comment">// 10% 可见就触发</span></span><br><span class="line">  <span class="attr">initDelay</span>: <span class="number">100</span>,        <span class="comment">// 初始化延迟（ms）</span></span><br><span class="line">&#125; <span class="keyword">as</span> <span class="keyword">const</span></span><br></pre></td></tr></table></figure>

<h4 id="IntersectionObserver-初始化"><a href="#IntersectionObserver-初始化" class="headerlink" title="IntersectionObserver 初始化"></a>IntersectionObserver 初始化</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">initLazyLoading</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!showAllPages.<span class="property">value</span> || totalPages.<span class="property">value</span> === <span class="number">0</span> || !pdfDocument.<span class="property">value</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理旧的观察器</span></span><br><span class="line">  <span class="keyword">if</span> (observer.<span class="property">value</span>) &#123;</span><br><span class="line">    observer.<span class="property">value</span>.<span class="title function_">disconnect</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 默认渲染第一页</span></span><br><span class="line">  <span class="keyword">if</span> (!renderedPages.<span class="property">value</span>.<span class="title function_">has</span>(<span class="number">1</span>)) &#123;</span><br><span class="line">    renderedPages.<span class="property">value</span>.<span class="title function_">add</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">renderPage</span>(<span class="number">1</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建新的观察器</span></span><br><span class="line">  observer.<span class="property">value</span> = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(</span><br><span class="line">    <span class="function"><span class="params">entries</span> =&gt;</span> &#123;</span><br><span class="line">      entries.<span class="title function_">forEach</span>(<span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> pageElement = entry.<span class="property">target</span> <span class="keyword">as</span> <span class="title class_">HTMLElement</span></span><br><span class="line">          <span class="keyword">const</span> page = <span class="title class_">Number</span>(pageElement.<span class="property">dataset</span>.<span class="property">page</span>)</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (page &amp;&amp; !renderedPages.<span class="property">value</span>.<span class="title function_">has</span>(page)) &#123;</span><br><span class="line">            renderedPages.<span class="property">value</span>.<span class="title function_">add</span>(page)</span><br><span class="line">            <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="title function_">renderPage</span>(page)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">root</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">rootMargin</span>: <span class="variable constant_">LAZY_LOADING_CONFIG</span>.<span class="property">rootMargin</span>,</span><br><span class="line">      <span class="attr">threshold</span>: <span class="variable constant_">LAZY_LOADING_CONFIG</span>.<span class="property">threshold</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 等待 DOM 更新后观察所有页面容器</span></span><br><span class="line">  <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> pageWrappers = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.pdf-page-wrapper&#x27;</span>)</span><br><span class="line">    pageWrappers.<span class="title function_">forEach</span>(<span class="function"><span class="params">wrapper</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> pageElement = wrapper <span class="keyword">as</span> <span class="title class_">HTMLElement</span></span><br><span class="line">      <span class="keyword">const</span> page = <span class="title class_">Number</span>(pageElement.<span class="property">dataset</span>.<span class="property">page</span>)</span><br><span class="line">      <span class="keyword">if</span> (!renderedPages.<span class="property">value</span>.<span class="title function_">has</span>(page)) &#123;</span><br><span class="line">        observer.<span class="property">value</span>?.<span class="title function_">observe</span>(wrapper)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="页面渲染"><a href="#页面渲染" class="headerlink" title="页面渲染"></a>页面渲染</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">renderPage</span> = <span class="keyword">async</span> (<span class="params">pageNumber: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!pdfDocument.<span class="property">value</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> canvas = canvasRefs.<span class="property">value</span>.<span class="title function_">get</span>(pageNumber)</span><br><span class="line">    <span class="keyword">if</span> (!canvas) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> page = <span class="keyword">await</span> pdfDocument.<span class="property">value</span>.<span class="title function_">getPage</span>(pageNumber)</span><br><span class="line">    <span class="keyword">const</span> viewport = page.<span class="title function_">getViewport</span>(&#123;</span><br><span class="line">      <span class="attr">scale</span>: <span class="number">1.5</span>,</span><br><span class="line">      <span class="attr">rotation</span>: currentRotation.<span class="property">value</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> context = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!context) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    canvas.<span class="property">width</span> = viewport.<span class="property">width</span></span><br><span class="line">    canvas.<span class="property">height</span> = viewport.<span class="property">height</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> page.<span class="title function_">render</span>(&#123;</span><br><span class="line">      <span class="attr">canvasContext</span>: context,</span><br><span class="line">      viewport,</span><br><span class="line">    &#125;).<span class="property">promise</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 页面渲染完成后释放资源</span></span><br><span class="line">    page.<span class="title function_">cleanup</span>()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`页面 <span class="subst">$&#123;pageNumber&#125;</span> 渲染失败:`</span>, error)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-旋转功能"><a href="#4-旋转功能" class="headerlink" title="4. 旋转功能"></a>4. 旋转功能</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 左转 90 度</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">rotateLeft</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  currentRotation.<span class="property">value</span> = (currentRotation.<span class="property">value</span> - <span class="number">90</span> + <span class="number">360</span>) % <span class="number">360</span></span><br><span class="line">  <span class="keyword">if</span> (showAllPages.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="title function_">reRenderAllPages</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 右转 90 度</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">rotateRight</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  currentRotation.<span class="property">value</span> = (currentRotation.<span class="property">value</span> + <span class="number">90</span>) % <span class="number">360</span></span><br><span class="line">  <span class="keyword">if</span> (showAllPages.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="title function_">reRenderAllPages</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新渲染所有已显示的页面</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reRenderAllPages</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!pdfDocument.<span class="property">value</span> || !showAllPages.<span class="property">value</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pagesToRerender = <span class="title class_">Array</span>.<span class="title function_">from</span>(renderedPages.<span class="property">value</span>)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> page <span class="keyword">of</span> pagesToRerender) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">nextTick</span>()</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">renderPage</span>(page)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-下载功能"><a href="#5-下载功能" class="headerlink" title="5. 下载功能"></a>5. 下载功能</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleDownload</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">validatePdfFormat</span>(props.<span class="property">source</span>)) &#123;</span><br><span class="line">      message.<span class="title function_">error</span>(<span class="string">&#x27;文件格式不正确，无法下载&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> fileName = toolbarConfig.<span class="property">value</span>.<span class="property">download</span>.<span class="property">fileName</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是 Blob，直接下载</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">source</span> <span class="keyword">instanceof</span> <span class="title class_">Blob</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">downloadByBlob</span>(props.<span class="property">source</span>, &#123;</span><br><span class="line">        fileName,</span><br><span class="line">        <span class="attr">mimeType</span>: <span class="string">&#x27;application/pdf&#x27;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是 ArrayBuffer 或 Uint8Array，转换为 Blob 后下载</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">source</span> <span class="keyword">instanceof</span> <span class="title class_">ArrayBuffer</span> || props.<span class="property">source</span> <span class="keyword">instanceof</span> <span class="title class_">Uint8Array</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([props.<span class="property">source</span>], &#123; <span class="attr">type</span>: <span class="string">&#x27;application/pdf&#x27;</span> &#125;)</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">downloadByBlob</span>(blob, &#123;</span><br><span class="line">        fileName,</span><br><span class="line">        <span class="attr">mimeType</span>: <span class="string">&#x27;application/pdf&#x27;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果是 URL，使用智能下载</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="keyword">typeof</span> props.<span class="property">source</span> === <span class="string">&#x27;string&#x27;</span> ? props.<span class="property">source</span> : props.<span class="property">source</span>?.<span class="title function_">toString</span>()</span><br><span class="line">    <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">      message.<span class="title function_">error</span>(<span class="string">&#x27;无法获取文件地址&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">downloadFile</span>(url, &#123; fileName &#125;)</span><br><span class="line">    message.<span class="title function_">success</span>(<span class="string">&#x27;下载成功&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;下载失败:&#x27;</span>, error)</span><br><span class="line">    message.<span class="title function_">error</span>(<span class="string">&#x27;下载失败&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-资源清理"><a href="#6-资源清理" class="headerlink" title="6. 资源清理"></a>6. 资源清理</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">cleanupPdfResources</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 清理 Blob URL</span></span><br><span class="line">  <span class="keyword">if</span> (blobUrl.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable constant_">URL</span>.<span class="title function_">revokeObjectURL</span>(blobUrl.<span class="property">value</span>)</span><br><span class="line">    blobUrl.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理 PDF 文档对象</span></span><br><span class="line">  <span class="keyword">if</span> (pdfDocument.<span class="property">value</span>) &#123;</span><br><span class="line">    pdfDocument.<span class="property">value</span>.<span class="title function_">destroy</span>().<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 忽略销毁错误</span></span><br><span class="line">    &#125;)</span><br><span class="line">    pdfDocument.<span class="property">value</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理观察器</span></span><br><span class="line">  <span class="keyword">if</span> (observer.<span class="property">value</span>) &#123;</span><br><span class="line">    observer.<span class="property">value</span>.<span class="title function_">disconnect</span>()</span><br><span class="line">    observer.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理状态</span></span><br><span class="line">  renderedPages.<span class="property">value</span>.<span class="title function_">clear</span>()</span><br><span class="line">  canvasRefs.<span class="property">value</span>.<span class="title function_">clear</span>()</span><br><span class="line">  isLoadingDocument.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件卸载时清理</span></span><br><span class="line"><span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">cleanupPdfResources</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h2><h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;PdfViewer :source=&quot;pdfUrl&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import PdfViewer from &#x27;@/components/PdfViewer/index.vue&#x27;</span><br><span class="line"></span><br><span class="line">const pdfUrl = &#x27;https://example.com/document.pdf&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="自定义工具栏"><a href="#自定义工具栏" class="headerlink" title="自定义工具栏"></a>自定义工具栏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;PdfViewer</span><br><span class="line">    :source=&quot;pdfUrl&quot;</span><br><span class="line">    :toolbar=&quot;&#123;</span><br><span class="line">      pagination: &#123;</span><br><span class="line">        enabled: true,</span><br><span class="line">        initialPage: 1,</span><br><span class="line">        showAllPages: false</span><br><span class="line">      &#125;,</span><br><span class="line">      rotation: &#123; enabled: true &#125;,</span><br><span class="line">      download: &#123; </span><br><span class="line">        enabled: true, </span><br><span class="line">        fileName: &#x27;my-document.pdf&#x27; </span><br><span class="line">      &#125;,</span><br><span class="line">      print: &#123; enabled: true &#125;</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="多页展示模式"><a href="#多页展示模式" class="headerlink" title="多页展示模式"></a>多页展示模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;PdfViewer</span><br><span class="line">    :source=&quot;pdfUrl&quot;</span><br><span class="line">    :toolbar=&quot;&#123;</span><br><span class="line">      pagination: &#123;</span><br><span class="line">        enabled: false,</span><br><span class="line">        showAllPages: true  // 显示所有页面</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    height=&quot;800px&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用-Blob-源"><a href="#使用-Blob-源" class="headerlink" title="使用 Blob 源"></a>使用 Blob 源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;PdfViewer :source=&quot;pdfBlob&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import PdfViewer from &#x27;@/components/PdfViewer/index.vue&#x27;</span><br><span class="line"></span><br><span class="line">const pdfBlob = ref&lt;Blob&gt;()</span><br><span class="line"></span><br><span class="line">// 从接口获取 PDF</span><br><span class="line">const loadPdf = async () =&gt; &#123;</span><br><span class="line">  const response = await fetch(&#x27;/api/pdf&#x27;)</span><br><span class="line">  pdfBlob.value = await response.blob()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loadPdf()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="监听事件"><a href="#监听事件" class="headerlink" title="监听事件"></a>监听事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;PdfViewer</span><br><span class="line">    :source=&quot;pdfUrl&quot;</span><br><span class="line">    @loaded=&quot;handleLoaded&quot;</span><br><span class="line">    @error=&quot;handleError&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">const handleLoaded = (totalPages: number) =&gt; &#123;</span><br><span class="line">  console.log(`PDF 加载成功，共 $&#123;totalPages&#125; 页`)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const handleError = (error: Error) =&gt; &#123;</span><br><span class="line">  console.error(&#x27;PDF 加载失败:&#x27;, error)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用暴露的方法"><a href="#使用暴露的方法" class="headerlink" title="使用暴露的方法"></a>使用暴露的方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;a-button @click=&quot;handleRotate&quot;&gt;旋转&lt;/a-button&gt;</span><br><span class="line">    &lt;a-button @click=&quot;handleDownload&quot;&gt;下载&lt;/a-button&gt;</span><br><span class="line">    &lt;PdfViewer ref=&quot;pdfViewerRef&quot; :source=&quot;pdfUrl&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import PdfViewer from &#x27;@/components/PdfViewer/index.vue&#x27;</span><br><span class="line"></span><br><span class="line">const pdfViewerRef = ref()</span><br><span class="line"></span><br><span class="line">const handleRotate = () =&gt; &#123;</span><br><span class="line">  pdfViewerRef.value?.rotateRight()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const handleDownload = () =&gt; &#123;</span><br><span class="line">  pdfViewerRef.value?.download()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="1-懒加载策略"><a href="#1-懒加载策略" class="headerlink" title="1. 懒加载策略"></a>1. 懒加载策略</h3><ul>
<li>使用 IntersectionObserver 监听页面可见性</li>
<li>只渲染可视区域附近的页面</li>
<li>提前 50px 预加载，提升用户体验</li>
</ul>
<h3 id="2-内存管理"><a href="#2-内存管理" class="headerlink" title="2. 内存管理"></a>2. 内存管理</h3><ul>
<li>及时调用 <code>page.cleanup()</code> 释放页面资源</li>
<li>使用 <code>markRaw()</code> 避免 PDF 对象被 Vue 响应式包装</li>
<li>组件卸载时彻底清理资源</li>
</ul>
<h3 id="3-Blob-URL-管理"><a href="#3-Blob-URL-管理" class="headerlink" title="3. Blob URL 管理"></a>3. Blob URL 管理</h3><ul>
<li>监听 source 变化，及时释放旧的 Blob URL</li>
<li>避免内存泄漏</li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="1-CORS-跨域问题"><a href="#1-CORS-跨域问题" class="headerlink" title="1. CORS 跨域问题"></a>1. CORS 跨域问题</h3><p>如果 PDF 文件在其他域名下，需要服务器配置 CORS 头：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Methods: GET</span><br></pre></td></tr></table></figure>

<h3 id="2-Worker-路径配置"><a href="#2-Worker-路径配置" class="headerlink" title="2. Worker 路径配置"></a>2. Worker 路径配置</h3><p>使用 CDN 或本地路径配置 worker：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 CDN（推荐）</span></span><br><span class="line">pdfjsLib.<span class="property">GlobalWorkerOptions</span>.<span class="property">workerSrc</span> = </span><br><span class="line">  <span class="string">`//unpkg.com/pdfjs-dist@<span class="subst">$&#123;pdfjsLib.version&#125;</span>/build/pdf.worker.min.mjs`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用本地文件</span></span><br><span class="line">pdfjsLib.<span class="property">GlobalWorkerOptions</span>.<span class="property">workerSrc</span> = <span class="string">&#x27;/pdf.worker.min.mjs&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-大文件处理"><a href="#3-大文件处理" class="headerlink" title="3. 大文件处理"></a>3. 大文件处理</h3><p>对于超大 PDF 文件：</p>
<ul>
<li>建议使用单页模式</li>
<li>或者使用多页模式 + 懒加载</li>
<li>避免一次性渲染所有页面</li>
</ul>
<h3 id="4-移动端适配"><a href="#4-移动端适配" class="headerlink" title="4. 移动端适配"></a>4. 移动端适配</h3><p>移动端需要注意：</p>
<ul>
<li>调整 scale 比例</li>
<li>优化触摸手势</li>
<li>减少初始加载页数</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本 PDF 查看器组件具有以下优势：</p>
<ol>
<li><strong>功能完善</strong>：支持单页&#x2F;多页、旋转、下载、打印等功能</li>
<li><strong>性能优化</strong>：懒加载、资源清理、响应式优化</li>
<li><strong>灵活配置</strong>：工具栏、页码、旋转等可自定义</li>
<li><strong>类型安全</strong>：完整的 TypeScript 类型定义</li>
<li><strong>易于使用</strong>：简洁的 API，丰富的使用示例</li>
</ol>
<p>适用于企业级 Web 应用中的文档预览场景。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://muziless.gitee.io/bolg">拾叁</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://muziless.gitee.io/bolg/2025/02/06/vue-pdf-viewer-component/">https://muziless.gitee.io/bolg/2025/02/06/vue-pdf-viewer-component/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/Vue3/">Vue3</a><a class="post-meta__tags" href="/blog/tags/PDF/">PDF</a><a class="post-meta__tags" href="/blog/tags/%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91/">组件开发</a><a class="post-meta__tags" href="/blog/tags/TypeScript/">TypeScript</a></div><div class="post_share"><div class="social-share" data-image="/blog/assets/cover/v3-6.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/2025/02/06/vue-skeleton-component/" title="Vue3 骨架屏组件库设计与实现"><img class="cover" src="/blog/assets/cover/v3-8.webp" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Vue3 骨架屏组件库设计与实现</div></div></a></div><div class="next-post pull-right"><a href="/blog/2025/02/06/micro-frontend-transformation/" title="微前端架构改造实践"><img class="cover" src="/blog/assets/cover/v3-15.webp" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">微前端架构改造实践</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/blog/2025/02/06/vue-filter-form-component/" title="Vue3 动态筛选表单组件设计"><img class="cover" src="/blog/assets/cover/v2-11.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-06</div><div class="title">Vue3 动态筛选表单组件设计</div></div></a></div><div><a href="/blog/2025/02/06/vue-skeleton-component/" title="Vue3 骨架屏组件库设计与实现"><img class="cover" src="/blog/assets/cover/v3-8.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-06</div><div class="title">Vue3 骨架屏组件库设计与实现</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/blog/assets/images/avatar.jpeg" onerror="this.onerror=null;this.src='/blog/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">拾叁</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/blog/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a><a href="/blog/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/blog/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/muziless/blog"><i></i><span>博客 Gitee</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://gitee.com/muziless" target="_blank" title="Gitee"><i class="fab fa-git" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1993516971@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="toc-number">2.</span> <span class="toc-text">核心特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">3.</span> <span class="toc-text">技术栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1"><span class="toc-number">4.</span> <span class="toc-text">组件接口设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Props"><span class="toc-number">4.1.</span> <span class="toc-text">Props</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E6%A0%8F%E9%85%8D%E7%BD%AE"><span class="toc-number">4.2.</span> <span class="toc-text">工具栏配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E9%9C%B2%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.4.</span> <span class="toc-text">暴露的方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.</span> <span class="toc-text">核心功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-PDF-js-%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.</span> <span class="toc-text">1. PDF.js 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Worker-%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.1.</span> <span class="toc-text">Worker 配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93%E6%94%AF%E6%8C%81"><span class="toc-number">5.1.2.</span> <span class="toc-text">中文字体支持</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-PDF-%E6%A0%BC%E5%BC%8F%E6%A0%A1%E9%AA%8C"><span class="toc-number">5.2.</span> <span class="toc-text">2. PDF 格式校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%87%92%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.3.</span> <span class="toc-text">3. 懒加载实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">5.3.1.</span> <span class="toc-text">配置参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IntersectionObserver-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">5.3.2.</span> <span class="toc-text">IntersectionObserver 初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93"><span class="toc-number">5.3.3.</span> <span class="toc-text">页面渲染</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%97%8B%E8%BD%AC%E5%8A%9F%E8%83%BD"><span class="toc-number">5.4.</span> <span class="toc-text">4. 旋转功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD"><span class="toc-number">5.5.</span> <span class="toc-text">5. 下载功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B5%84%E6%BA%90%E6%B8%85%E7%90%86"><span class="toc-number">5.6.</span> <span class="toc-text">6. 资源清理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">6.</span> <span class="toc-text">使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">6.1.</span> <span class="toc-text">基础使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B7%A5%E5%85%B7%E6%A0%8F"><span class="toc-number">6.2.</span> <span class="toc-text">自定义工具栏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%A1%B5%E5%B1%95%E7%A4%BA%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.3.</span> <span class="toc-text">多页展示模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Blob-%E6%BA%90"><span class="toc-number">6.4.</span> <span class="toc-text">使用 Blob 源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="toc-number">6.5.</span> <span class="toc-text">监听事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9A%B4%E9%9C%B2%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">6.6.</span> <span class="toc-text">使用暴露的方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">7.</span> <span class="toc-text">性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%87%92%E5%8A%A0%E8%BD%BD%E7%AD%96%E7%95%A5"><span class="toc-number">7.1.</span> <span class="toc-text">1. 懒加载策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">7.2.</span> <span class="toc-text">2. 内存管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Blob-URL-%E7%AE%A1%E7%90%86"><span class="toc-number">7.3.</span> <span class="toc-text">3. Blob URL 管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">8.</span> <span class="toc-text">注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CORS-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">8.1.</span> <span class="toc-text">1. CORS 跨域问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Worker-%E8%B7%AF%E5%BE%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.2.</span> <span class="toc-text">2. Worker 路径配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%A7%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">8.3.</span> <span class="toc-text">3. 大文件处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D"><span class="toc-number">8.4.</span> <span class="toc-text">4. 移动端适配</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/02/06/vue-filter-form-component/" title="Vue3 动态筛选表单组件设计"><img src="/blog/assets/cover/v2-11.webp" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Vue3 动态筛选表单组件设计"/></a><div class="content"><a class="title" href="/blog/2025/02/06/vue-filter-form-component/" title="Vue3 动态筛选表单组件设计">Vue3 动态筛选表单组件设计</a><time datetime="2025-02-06T09:45:00.000Z" title="Created 2025-02-06 17:45:00">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/02/06/vue-skeleton-component/" title="Vue3 骨架屏组件库设计与实现"><img src="/blog/assets/cover/v3-8.webp" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Vue3 骨架屏组件库设计与实现"/></a><div class="content"><a class="title" href="/blog/2025/02/06/vue-skeleton-component/" title="Vue3 骨架屏组件库设计与实现">Vue3 骨架屏组件库设计与实现</a><time datetime="2025-02-06T08:45:00.000Z" title="Created 2025-02-06 16:45:00">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/02/06/vue-pdf-viewer-component/" title="Vue3 PDF查看器组件实现"><img src="/blog/assets/cover/v3-6.webp" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Vue3 PDF查看器组件实现"/></a><div class="content"><a class="title" href="/blog/2025/02/06/vue-pdf-viewer-component/" title="Vue3 PDF查看器组件实现">Vue3 PDF查看器组件实现</a><time datetime="2025-02-06T08:40:00.000Z" title="Created 2025-02-06 16:40:00">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/02/06/micro-frontend-transformation/" title="微前端架构改造实践"><img src="/blog/assets/cover/v3-15.webp" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="微前端架构改造实践"/></a><div class="content"><a class="title" href="/blog/2025/02/06/micro-frontend-transformation/" title="微前端架构改造实践">微前端架构改造实践</a><time datetime="2025-02-06T08:35:00.000Z" title="Created 2025-02-06 16:35:00">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/02/06/iframe-communication/" title="iframe通信方案"><img src="/blog/assets/cover/v2-1.webp" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="iframe通信方案"/></a><div class="content"><a class="title" href="/blog/2025/02/06/iframe-communication/" title="iframe通信方案">iframe通信方案</a><time datetime="2025-02-06T08:30:00.000Z" title="Created 2025-02-06 16:30:00">2025-02-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/blog/assets/cover/v3-6.webp')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2026 By 拾叁</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>